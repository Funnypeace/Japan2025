<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interaktiver Reiseplan: Japan 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9; /* slate-100 */
        }
        .section-title {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 700; /* font-bold */
            color: #1e293b; /* slate-800 */
            margin-bottom: 1.5rem; /* mb-6 */
            text-align: center;
        }
        .nav-link {
            transition: all 0.2s ease-in-out;
            border-bottom: 2px solid transparent;
        }
        .nav-link:hover, .nav-link.active {
            color: #f59e0b; /* amber-500 */
            border-bottom-color: #f59e0b; /* amber-500 */
        }
        .filter-btn {
            transition: all 0.2s ease-in-out;
        }
        .filter-btn.active {
            background-color: #f59e0b; /* amber-500 */
            color: #ffffff;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .day-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .day-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .day-card.highlight {
            background-color: #fef3c7; /* amber-100 */
            border-color: #f59e0b; /* amber-500 */
        }
        .day-card.pre-booked {
            position: relative;
            background-color: #dbeafe; /* blue-200 */
            border-color: #3b82f6; /* blue-500 */
        }
        .day-card.pre-booked::after {
            content: '‚òÖ';
            position: absolute;
            top: 8px;
            right: 8px;
            color: #3b82f6;
            font-size: 1.25rem;
        }
        .modal-content {
            max-height: 80vh;
        }
        .activity-item.highlighted {
            background-color: #fefce8; /* yellow-50 */
            border-left: 4px solid #f59e0b; /* amber-500 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 300px;
                max-height: 350px;
            }
        }
    </style>
</head>
<body class="text-slate-700">

    <header class="bg-slate-800 text-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl md:text-2xl font-bold text-amber-400">Japan 2025</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#overview" class="nav-link px-3 py-2 rounded-md text-sm font-medium">√úbersicht</a>
                        <a href="#itinerary" class="nav-link px-3 py-2 rounded-md text-sm font-medium">Reiseplan</a>
                        <a href="#transport" class="nav-link px-3 py-2 rounded-md text-sm font-medium">Transport & Tipps</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-slate-400 hover:text-white hover:bg-slate-700 focus:outline-none">
                        <span class="sr-only">Men√º √∂ffnen</span>
                        <svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </nav>
        <div id="mobile-menu" class="md:hidden hidden">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#overview" class="nav-link block px-3 py-2 rounded-md text-base font-medium">√úbersicht</a>
                <a href="#itinerary" class="nav-link block px-3 py-2 rounded-md text-base font-medium">Reiseplan</a>
                <a href="#transport" class="nav-link block px-3 py-2 rounded-md text-base font-medium">Transport & Tipps</a>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

        <section id="overview" class="mb-16 scroll-mt-20">
            <h2 class="section-title">Reise√ºbersicht</h2>
            <p class="text-center max-w-3xl mx-auto mb-10 text-slate-600">Willkommen zu Ihrer Reise durch Japan! Diese √úbersicht fasst die wichtigsten Eckdaten und die Verteilung Ihrer Aufenthalte zusammen. Der Fokus liegt auf einer unvergesslichen Mischung aus Technologie, Anime und traditioneller Kultur.</p>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
                <div class="bg-white p-6 rounded-lg shadow-md flex items-center space-x-4">
                    <span class="text-4xl">‚úàÔ∏è</span>
                    <div>
                        <h3 class="font-bold text-slate-800">Flugdaten</h3>
                        <p class="text-sm">Ankunft: 18. Juni, 22:30 HND</p>
                        <p class="text-sm">Abflug: 04. Juli, 00:05 HND</p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md flex items-center space-x-4">
                    <span class="text-4xl">üóìÔ∏è</span>
                    <div>
                        <h3 class="font-bold text-slate-800">Reisedauer</h3>
                        <p class="text-lg">17 Tage / 15 N√§chte</p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md flex items-center space-x-4">
                    <span class="text-4xl">üè®</span>
                    <div>
                        <h3 class="font-bold text-slate-800">Unterk√ºnfte</h3>
                        <p class="text-lg">4 Hotels in 3 St√§dten</p>
                    </div>
                </div>
            </div>

            <div class="bg-white p-6 md:p-8 rounded-lg shadow-md mb-12">
                <h3 class="text-xl font-bold text-slate-800 mb-4 text-center">N√§chte pro Stadt</h3>
                <div class="chart-container">
                    <canvas id="nightsPerCityChart"></canvas>
                </div>
            </div>

            <div class="bg-white p-6 md:p-8 rounded-lg shadow-md">
                <h3 class="text-xl font-bold text-slate-800 mb-4 text-center">Gebuchte Hotels</h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-left">
                        <thead class="bg-slate-50 text-slate-600">
                            <tr>
                                <th class="p-4 font-medium">Hotel</th>
                                <th class="p-4 font-medium">Stadt</th>
                                <th class="p-4 font-medium">Check-in</th>
                                <th class="p-4 font-medium">Check-out</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-200">
                            <tr><td class="p-4">Hotel Villa Fontaine Tokyo Hamamatsucho</td><td class="p-4">Tokio</td><td class="p-4">18. Juni</td><td class="p-4">21. Juni</td></tr>
                            <tr><td class="p-4">Almont Hotel Kyoto</td><td class="p-4">Kyoto</td><td class="p-4">21. Juni</td><td class="p-4">24. Juni</td></tr>
                            <tr><td class="p-4">Smile Hotel Shinosaka</td><td class="p-4">Osaka</td><td class="p-4">24. Juni</td><td class="p-4">29. Juni</td></tr>
                            <tr><td class="p-4">Shinjuku Granbell Hotel</td><td class="p-4">Tokio</td><td class="p-4">29. Juni</td><td class="p-4">03. Juli</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </section>

        <section id="itinerary" class="mb-16 scroll-mt-20">
            <h2 class="section-title">Interaktiver Reiseplan</h2>
            <p class="text-center max-w-3xl mx-auto mb-6 text-slate-600">Klicken Sie auf einen Tag, um die detaillierte Planung zu sehen. Nutzen Sie die Filter, um Aktivit√§ten nach Ihren Interessen hervorzuheben. Tage mit bereits fest gebuchten Hauptaktivit√§ten sind mit einem ‚òÖ markiert.</p>

            <div class="flex justify-center flex-wrap gap-2 md:gap-4 mb-8" id="theme-filters">
                <button class="filter-btn active px-4 py-2 text-sm font-medium rounded-full bg-white shadow-sm border border-slate-200" data-filter="all">Alle anzeigen</button>
                <button class="filter-btn px-4 py-2 text-sm font-medium rounded-full bg-white shadow-sm border border-slate-200" data-filter="technologie">üñ•Ô∏è Technologie</button>
                <button class="filter-btn px-4 py-2 text-sm font-medium rounded-full bg-white shadow-sm border border-slate-200" data-filter="anime">üé® Anime</button>
                <button class="filter-btn px-4 py-2 text-sm font-medium rounded-full bg-white shadow-sm border border-slate-200" data-filter="kultur">‚õ©Ô∏è Kultur</button>
            </div>

            <div id="itinerary-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
            </div>
        </section>

        <section id="transport" class="scroll-mt-20">
            <h2 class="section-title">Transport & Reisetipps</h2>
            <p class="text-center max-w-3xl mx-auto mb-10 text-slate-600">Effiziente Fortbewegung ist in Japan der Schl√ºssel. Hier finden Sie eine Kostenanalyse f√ºr Zugreisen und wichtige allgemeine Tipps, die Ihnen die Reise erleichtern werden.</p>
            
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white p-6 md:p-8 rounded-lg shadow-md">
                    <h3 class="text-xl font-bold text-slate-800 mb-4 text-center">Kostenanalyse: Shinkansen</h3>
                    <div class="chart-container h-80 md:h-96">
                        <canvas id="transportCostChart"></canvas>
                    </div>
                    <p class="text-sm text-center mt-4 text-slate-500">Empfehlung: Kombination aus Einzeltickets und dem kosteng√ºnstigeren JR Kansai-Hiroshima Area Pass f√ºr die Tage in der Kansai-Region.</p>
                </div>

                <div class="bg-white p-6 md:p-8 rounded-lg shadow-md">
                    <h3 class="text-xl font-bold text-slate-800 mb-6 text-center">Wichtige Tipps</h3>
                    <div id="tips-accordion" class="space-y-4">
                        <div class="accordion-item">
                            <button class="accordion-header w-full text-left flex justify-between items-center p-4 bg-slate-50 hover:bg-slate-100 rounded-lg">
                                <span class="font-semibold text-slate-700">Geld & W√§hrung</span>
                                <span class="accordion-icon text-amber-500 font-bold text-xl">+</span>
                            </button>
                            <div class="accordion-content hidden p-4 border-t border-slate-200">
                                <p>Japan ist bargeld-freundlich. F√ºhren Sie immer etwas Bargeld mit sich. Kreditkarten werden in gro√üen Gesch√§ften und Hotels akzeptiert. Geldautomaten in Convenience Stores (7-Eleven, Lawson) sind ideal f√ºr Abhebungen.</p>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <button class="accordion-header w-full text-left flex justify-between items-center p-4 bg-slate-50 hover:bg-slate-100rounded-lg">
                                <span class="font-semibold text-slate-700">Kommunikation & Internet</span>
                                <span class="accordion-icon text-amber-500 font-bold text-xl">+</span>
                            </button>
                            <div class="accordion-content hidden p-4 border-t border-slate-200">
                                <p>Ein Pocket Wi-Fi oder eine eSIM ist f√ºr die Navigation (Google Maps) und √úbersetzung unerl√§sslich. Dies sichert st√§ndigen Internetzugang.</p>
                            </div>
                        </div>
                        <div class="accordion-item">
                            <button class="accordion-header w-full text-left flex justify-between items-center p-4 bg-slate-50 hover:bg-slate-100 rounded-lg">
                                <span class="font-semibold text-slate-700">Etikette</span>
                                <span class="accordion-icon text-amber-500 font-bold text-xl">+</span>
                            </button>
                            <div class="accordion-content hidden p-4 border-t border-slate-200">
                                <p>H√∂flichkeit ist wichtig. Verbeugen ist ein √ºblicher Gru√ü. Vermeiden Sie laute Gespr√§che in √∂ffentlichen Verkehrsmitteln und essen/trinken Sie nicht beim Gehen auf der Stra√üe.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="voice-memos" class="mb-16 scroll-mt-20">
            <h2 class="section-title">T√§gliche Voice Memos</h2>
            <div id="voiceMemoApp"></div>
        </section>

    </main>

    <footer class="bg-slate-800 text-white mt-16">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 text-center text-sm text-slate-400">
            <p>Ihr pers√∂nlicher Reiseplan f√ºr Japan | Juni/Juli 2025</p>
        </div>
    </footer>
    
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-2xl w-full max-w-2xl transform transition-all">
            <div class="flex justify-between items-center p-4 border-b border-slate-200">
                <h3 id="modal-title" class="text-xl font-bold text-slate-800"></h3>
                <button id="modal-close" class="text-slate-500 hover:text-slate-800 text-2xl">&times;</button>
            </div>
            <div id="modal-content" class="p-6 overflow-y-auto"></div>
        </div>
    </div>

    <script>
        const itineraryData = [
            { day: 1, date: "18. Juni", location: "Tokio", title: "Ankunft", themes: [], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item"><strong class="text-amber-600">Abend (22:30 Uhr):</strong> Ankunft am Flughafen Tokio Haneda (HND).</div>
                    <div class="activity-item"><strong class="text-amber-600">Danach:</strong> Einchecken im Hotel Villa Fontaine Tokyo Hamamatsucho.</div>
                </div>` },
            { day: 2, date: "19. Juni", location: "Tokio", title: "Parks, Kultur & Skyline", themes: ['kultur'], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item" data-theme="kultur"><strong class="text-amber-600">Vormittag:</strong> Tokyo Tower, Shiba Park &amp; Z≈çj≈ç-ji Tempel besuchen.</div>
                    <div class="activity-item" data-theme="kultur"><strong class="text-amber-600">Mittag:</strong> Essen bei Gonpachi Nishi-Azabu &amp; Roppongi Hills Aussicht.</div>
                    <div class="activity-item" data-theme="kultur"><strong class="text-amber-600">Nachmittag:</strong> Besuch des Hamariky≈´-Parks (Hamarikyu Gardens).</div>
                    <div class="activity-item"><strong class="text-amber-600">Abend:</strong> Erkundung von Takeshiba am Wasser f√ºr die Skyline (Tokyo, Takeshiba).</div>
                    <div class="activity-item">Zusammengefasst: <a href="https://maps.app.goo.gl/TCNHeU8EuVGebMVM8" target="_blank">Maps-Link</a></div>
                </div>` },
            { day: 3, date: "20. Juni", location: "Tokio", title: "Shibuya & Kultur", themes: ['kultur','anime'], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item"><strong class="text-amber-600">Vormittag:</strong> Shibuya Scramble Crossing &amp; Shopping bei MEGA Don Quijote.</div>
                    <div class="activity-item" data-theme="kultur anime"><strong class="text-amber-600">Nachmittag:</strong> Meiji Jingu &amp; Takeshita Street &amp; ONE PIECE Straw Hat Store - Shibuya Main Store.</div>
                    <div class="activity-item" data-theme="kultur"><strong class="text-amber-600">Optional:</strong> Imperial Palace / Kaiserpalast Tokio.</div>
                </div>` },
            { day: 4, date: "21. Juni", location: "Tokio ‚Üí Kyoto", title: "Reise & Tempel", themes: ['kultur'], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item"><strong class="text-amber-600">Vormittag:</strong> Auschecken Hotel: Villa Fontaine Tokyo Hamamatsucho.</div>
                    <div class="activity-item"><strong class="text-amber-600">Nachmittag:</strong> Einchecken Hotel: Almont Hotel Kyoto.</div>
                    <div class="activity-item" data-theme="kultur"><strong class="text-amber-600">Abend:</strong> Kinkaku-ji Goldener Pavillon &amp; Kiyomizu-dera Tempel Abends.</div>
                </div>` },
            { day: 5, date: "22. Juni", location: "Kyoto", title: "Fushimi Inari & Arashiyama", themes: ['kultur'], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item" data-theme="kultur"><strong class="text-amber-600">Fr√ºh morgens:</strong> Fushimi Inari Taisha Schrein.</div>
                    <div class="activity-item" data-theme="kultur"><strong class="text-amber-600">Vormittag:</strong> Arashiyama Bambuswald (Bamboo Grove).</div>
                    <div class="activity-item"><strong class="text-amber-600">Rest des Tages:</strong> Freie Gestaltung in Kyoto.</div>
                </div>` },
            { day: 6, date: "23. Juni", location: "Kyoto", title: "Freier Tag", themes: [], preBooked: false, details: `<p>Dieser Tag steht zur freien Verf√ºgung in Kyoto.</p>` },
            { day: 7, date: "24. Juni", location: "Kyoto ‚Üí Osaka", title: "Reise nach Osaka", themes: [], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item"><strong class="text-amber-600">Vormittag:</strong> Auschecken Hotel: Almont Hotel Kyoto.</div>
                    <div class="activity-item"><strong class="text-amber-600">Nachmittag:</strong> Einchecken Hotel: Smile Hotel Shinosaka.</div>
                    <div class="activity-item"><strong class="text-amber-600">Abend:</strong> Freie Gestaltung in Osaka.</div>
                </div>` },
            { day: 8, date: "25. Juni", location: "Osaka", title: "Universal Studios Japan", themes: ['anime'], preBooked: true, details: `
                <div class="space-y-4">
                    <div class="activity-item" data-theme="anime"><strong class="text-amber-600">Ganzt√§gig:</strong> Universal Studios Japan.</div>
                </div>` },
            { day: 9, date: "26. Juni", location: "Osaka", title: "Weltausstellung Expo 2025", themes: ['technologie'], preBooked: true, details: `
                <div class="space-y-4">
                    <div class="activity-item" data-theme="technologie"><strong class="text-amber-600">Ganzt√§gig:</strong> Weltausstellung Expo 2025 (Tickets gebucht am 16.03.2025).</div>
                </div>` },
            { day: 10, date: "27. Juni", location: "Hiroshima", title: "Ausflug Hiroshima", themes: ['kultur'], preBooked: true, details: `
                <div class="space-y-4">
                    <div class="activity-item" data-theme="kultur"><strong class="text-amber-600">Ganzt√§gig:</strong> Ausflug Hiroshima: HIROSHIMA GATE PARK + Prayer Fountain.</div>
                </div>` },
            { day: 11, date: "28. Juni", location: "Osaka", title: "Freier Tag", themes: [], preBooked: false, details: `<p>Dieser Tag steht zur freien Verf√ºgung in Osaka.</p>` },
            { day: 12, date: "29. Juni", location: "Osaka ‚Üí Tokio", title: "Reise & Anime", themes: ['anime','technologie'], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item"><strong class="text-amber-600">Vormittag:</strong> Auschecken Hotel: Smile Hotel Shinosaka.</div>
                    <div class="activity-item"><strong class="text-amber-600">Nachmittag:</strong> Einchecken Hotel: Shinjuku Granbell Hotel.</div>
                    <div class="activity-item" data-theme="anime technologie"><strong class="text-amber-600">Abend:</strong> Ab zur Akihabara Station ‚Äì Erkundung des Anime-/Elektro-Viertels.</div>
                </div>` },
            { day: 13, date: "30. Juni", location: "Tokio", title: "Sens≈ç-ji Tempel", themes: ['kultur'], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item" data-theme="kultur"><strong class="text-amber-600">Ganzt√§gig:</strong> Tempel Sens≈ç-ji.</div>
                </div>` },
            { day: 14, date: "1. Juli", location: "Tokio", title: "Anime & Elektro", themes: ['anime','technologie'], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item" data-theme="anime technologie"><strong class="text-amber-600">Ganzt√§gig:</strong> Ab zur Akihabara Station ‚Äì Erkundung des Anime-/Elektro-Viertels.</div>
                </div>` },
            { day: 15, date: "2. Juli", location: "Tokio", title: "Freier Tag", themes: [], preBooked: false, details: `<p>Dieser Tag steht zur freien Verf√ºgung in Tokio.</p>` },
            { day: 16, date: "3. Juli", location: "Tokio", title: "Auschecken", themes: [], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item"><strong class="text-amber-600">Ganzt√§gig:</strong> Auschecken Hotel: Shinjuku Granbell Hotel.</div>
                </div>` },
            { day: 17, date: "4. Juli", location: "Tokio", title: "Abreise", themes: [], preBooked: false, details: `
                <div class="space-y-4">
                    <div class="activity-item"><strong class="text-amber-600">Sehr fr√ºh (0:05 Uhr):</strong> Abflug aus Tokio.</div>
                </div>` },
        ];

        document.addEventListener('DOMContentLoaded', () => {
            const app = {
                activeFilter: 'all',
                init() {
                    this.setupEventListeners();
                    this.renderItineraryGrid();
                    this.renderCharts();
                    this.setActiveNavLink();
                },
                setupEventListeners() {
                    document.getElementById('mobile-menu-button').addEventListener('click', () => {
                        document.getElementById('mobile-menu').classList.toggle('hidden');
                    });

                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.addEventListener('click', (e) => {
                            if (window.innerWidth < 768) {
                                document.getElementById('mobile-menu').classList.add('hidden');
                            }
                            const targetId = link.getAttribute('href');
                            const targetElement = document.querySelector(targetId);
                            if (targetElement) {
                                e.preventDefault();
                                targetElement.scrollIntoView({ behavior: 'smooth' });
                                setTimeout(() => this.setActiveNavLink(), 50);
                            }
                        });
                    });

                    document.getElementById('theme-filters').addEventListener('click', e => {
                        if (e.target.tagName === 'BUTTON') {
                            this.activeFilter = e.target.dataset.filter;
                            this.updateFilterButtons();
                            this.updateDayCardsHighlight();
                        }
                    });

                    document.getElementById('itinerary-grid').addEventListener('click', e => {
                        const card = e.target.closest('.day-card');
                        if (card) this.openModal(card.dataset.day);
                    });

                    document.getElementById('modal-close').addEventListener('click', () => this.closeModal());
                    document.getElementById('modal').addEventListener('click', e => {
                        if (e.target.id === 'modal') this.closeModal();
                    });

                    document.getElementById('tips-accordion').addEventListener('click', e => {
                        const header = e.target.closest('.accordion-header');
                        if (header) {
                            const content = header.nextElementSibling;
                            const icon = header.querySelector('.accordion-icon');
                            const isHidden = content.classList.toggle('hidden');
                            icon.textContent = isHidden ? '+' : '‚àí';
                            document.querySelectorAll('#tips-accordion .accordion-content').forEach(other => {
                                if (other !== content && !other.classList.contains('hidden')) {
                                    other.classList.add('hidden');
                                    other.previousElementSibling.querySelector('.accordion-icon').textContent = '+';
                                }
                            });
                        }
                    });

                    window.addEventListener('scroll', () => this.setActiveNavLink());
                    window.addEventListener('resize', () => this.setActiveNavLink());
                },
                renderItineraryGrid() {
                    const grid = document.getElementById('itinerary-grid');
                    grid.innerHTML = itineraryData.map(day => `
                        <div class="day-card bg-white p-4 rounded-lg shadow-md border-2 border-transparent cursor-pointer ${day.preBooked ? 'pre-booked' : ''}" data-day="${day.day}" tabindex="0" role="button" aria-label="Details f√ºr Tag ${day.day}: ${day.title}">
                            <p class="font-bold text-sm text-slate-800">Tag ${day.day}</p>
                            <p class="text-xs text-slate-500 mb-1">${day.date}</p>
                            <p class="text-slate-700 font-semibold">${day.location}</p>
                            <p class="text-xs text-slate-600 truncate">${day.title}</p>
                        </div>
                    `).join('');
                },
                updateFilterButtons() {
                    document.querySelectorAll('#theme-filters button').forEach(btn => {
                        btn.classList.toggle('active', btn.dataset.filter === this.activeFilter);
                    });
                },
                updateDayCardsHighlight() {
                    document.querySelectorAll('.day-card').forEach(card => {
                        const day = itineraryData[card.dataset.day - 1];
                        const hasTheme = this.activeFilter === 'all' || (day.themes.includes(this.activeFilter));
                        card.classList.toggle('highlight', hasTheme && this.activeFilter !== 'all');
                        card.style.opacity = hasTheme || this.activeFilter === 'all' ? '1' : '0.5';
                    });
                },
                openModal(dayNum) {
                    const day = itineraryData[dayNum - 1];
                    document.getElementById('modal-title').textContent = `Tag ${day.day}: ${day.title} (${day.date})`;
                    const modalContent = document.getElementById('modal-content');
                    modalContent.innerHTML = day.details;
                    modalContent.querySelectorAll('.activity-item').forEach(item => {
                        const themes = (item.dataset.theme || '').split(' ');
                        if (this.activeFilter !== 'all' && themes.includes(this.activeFilter)) {
                            item.classList.add('highlighted');
                        } else {
                            item.classList.remove('highlighted');
                        }
                    });
                    const modal = document.getElementById('modal');
                    modal.classList.remove('hidden');
                    modal.classList.add('flex');
                    modal.setAttribute('aria-hidden', 'false');
                    document.body.style.overflow = 'hidden';
                    document.getElementById('modal-close').focus();
                },
                closeModal() {
                    const modal = document.getElementById('modal');
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                    modal.setAttribute('aria-hidden', 'true');
                    document.body.style.overflow = '';
                },
                setActiveNavLink() {
                    let current = '';
                    const sections = document.querySelectorAll('main section[id]');
                    const offset = document.querySelector('header').offsetHeight + 20;
                    sections.forEach(sec => {
                        const top = sec.offsetTop - offset;
                        const bottom = top + sec.offsetHeight;
                        if (pageYOffset >= top && pageYOffset < bottom) current = sec.id;
                    });
                    if (!current) {
                        if (pageYOffset < sections[0].offsetTop - offset) current = sections[0].id;
                        else current = sections[sections.length - 1].id;
                    }
                    document.querySelectorAll('.nav-link').forEach(link => {
                        link.classList.toggle('active', link.getAttribute('href') === `#${current}`);
                    });
                },
                renderCharts() {
                    const nightsCtx = document.getElementById('nightsPerCityChart');
                    if (nightsCtx) {
                        new Chart(nightsCtx.getContext('2d'), {
                            type: 'bar',
                            data: {
                                labels: ['Tokio (Start)', 'Kyoto', 'Osaka', 'Tokio (Ende)'],
                                datasets: [{
                                    label: 'Anzahl N√§chte',
                                    data: [3, 3, 5, 4],
                                    backgroundColor: ['#7dd3fc','#fcd34d','#f87171','#7dd3fc'],
                                    borderColor: ['#0ea5e9','#facc15','#ef4444','#0ea5e9'],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                indexAxis: 'y',
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: { legend:{display:false}, title:{display:false} },
                                scales: {
                                    x:{ beginAtZero:true, grid:{color:'#e2e8f0'} },
                                    y:{ grid:{display:false} }
                                }
                            }
                        });
                    }
                    const transportCtx = document.getElementById('transportCostChart');
                    if (transportCtx) {
                        const jpy = [52710,50000,80000];
                        const rate = 0.0061;
                        const eur = jpy.map(c=>parseFloat((c*rate).toFixed(2)));
                        new Chart(transportCtx.getContext('2d'), {
                            type:'bar',
                            data:{
                                labels:['Einzel-/Regionaltickets','JR Pass 7 Tage','JR Pass 14 Tage'],
                                datasets:[{
                                    label:'Gesch√§tzte Kosten in Euro (‚Ç¨)',
                                    data:eur,
                                    backgroundColor:['#6ee7b7','#fcd34d','#f87171'],
                                    borderColor:['#10b981','#facc15','#ef4444','#f59e0b'],
                                    borderWidth:1
                                }]
                            },
                            options:{
                                responsive:true,
                                maintainAspectRatio:false,
                                plugins:{
                                    legend:{display:false},
                                    title:{display:true,text:'Vergleich der Transportkosten',padding:{bottom:20},font:{size:16}}
                                },
                                scales:{
                                    y:{
                                        beginAtZero:true,
                                        ticks:{callback:v=>v.toLocaleString('de-DE',{style:'currency',currency:'EUR'})},
                                        grid:{color:'#e2e8f0'}
                                    },
                                    x:{grid:{display:false}}
                                }
                            }
                        });
                    }
                }
            };
            app.init();
        });
    </script>

    <!-- React and Voice Memo App -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        function VoiceMemoApp() {
            const [isRecording, setIsRecording] = useState(false);
            const [audioBlob, setAudioBlob] = useState(null);
            const [transcript, setTranscript] = useState('');
            const [summary, setSummary] = useState('');
            const [isPlaying, setIsPlaying] = useState(false);
            const [memos, setMemos] = useState([]);

            const OPENAI_API_KEY = 'YOUR_OPENAI_API_KEY';

            const mediaRecorder = useRef(null);
            const audioRef = useRef(null);
            const recognition = useRef(null);

            useEffect(() => {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    recognition.current = new SpeechRecognition();
                    recognition.current.continuous = true;
                    recognition.current.interimResults = true;
                    recognition.current.lang = 'de-DE';
                    recognition.current.onresult = (event) => {
                        let finalTranscript = '';
                        for (let i = event.resultIndex; i < event.results.length; i++) {
                            if (event.results[i].isFinal) {
                                finalTranscript += event.results[i][0].transcript;
                            }
                        }
                        if (finalTranscript) {
                            setTranscript(prev => prev + finalTranscript + ' ');
                        }
                    };
                }
            }, []);

            const startRecording = async () => {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder.current = new MediaRecorder(stream);
                    const chunks = [];
                    mediaRecorder.current.ondataavailable = (event) => {
                        chunks.push(event.data);
                    };
                    mediaRecorder.current.onstop = () => {
                        const blob = new Blob(chunks, { type: 'audio/wav' });
                        setAudioBlob(blob);
                        stream.getTracks().forEach(track => track.stop());
                    };
                    mediaRecorder.current.start();
                    setIsRecording(true);
                    setTranscript('');
                    setSummary('');
                    if (recognition.current) {
                        recognition.current.start();
                    }
                } catch (error) {
                    console.error('Fehler beim Starten der Aufnahme:', error);
                    alert('Mikrofonzugriff wurde verweigert oder ist nicht verf√ºgbar.');
                }
            };

            const stopRecording = () => {
                if (mediaRecorder.current && isRecording) {
                    mediaRecorder.current.stop();
                    setIsRecording(false);
                    if (recognition.current) {
                        recognition.current.stop();
                    }
                    setTimeout(() => generateSummary(), 1000);
                }
            };

            const generateSummary = async () => {
                if (!transcript.trim()) return;
                try {
                    const prompt =
                        `Fasse den folgenden Text in maximal 5 Stichpunkten zusammen:\n${transcript}`;
                    const response = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            Authorization: `Bearer ${OPENAI_API_KEY}`,
                        },
                        body: JSON.stringify({
                            model: 'gpt-3.5-turbo',
                            messages: [{ role: 'user', content: prompt }],
                            temperature: 0.7,
                        }),
                    });
                    const data = await response.json();
                    if (data.choices && data.choices.length > 0) {
                        setSummary(data.choices[0].message.content.trim());
                        return;
                    }
                } catch (error) {
                    console.error('Fehler beim Generieren der Zusammenfassung:', error);
                }
                const sentences = transcript.split(/[.!?]+/).filter(s => s.trim().length > 0);
                const bulletPoints = sentences
                    .slice(0, 5)
                    .map(s => s.trim())
                    .filter(s => s.length > 10)
                    .map(s => `\u2022 ${s.charAt(0).toUpperCase() + s.slice(1)}`);
                setSummary(bulletPoints.join('\n'));
            };

            const playAudio = () => {
                if (audioBlob && audioRef.current) {
                    if (isPlaying) {
                        audioRef.current.pause();
                        setIsPlaying(false);
                    } else {
                        const audioUrl = URL.createObjectURL(audioBlob);
                        audioRef.current.src = audioUrl;
                        audioRef.current.play();
                        setIsPlaying(true);
                        audioRef.current.onended = () => {
                            setIsPlaying(false);
                            URL.revokeObjectURL(audioUrl);
                        };
                    }
                }
            };

            const saveMemo = () => {
                if (!transcript.trim() && !audioBlob) return;
                const memo = {
                    id: Date.now(),
                    date: new Date().toLocaleDateString('de-DE'),
                    time: new Date().toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' }),
                    transcript: transcript.trim(),
                    summary,
                    audioBlob
                };
                setMemos(prev => [memo, ...prev]);
                clearCurrentMemo();
                alert('Memo gespeichert!');
            };

            const clearCurrentMemo = () => {
                setTranscript('');
                setSummary('');
                setAudioBlob(null);
                setIsPlaying(false);
            };

            const deleteMemo = (id) => {
                setMemos(prev => prev.filter(memo => memo.id !== id));
            };

            const loadMemo = (memo) => {
                setTranscript(memo.transcript);
                setSummary(memo.summary);
                setAudioBlob(memo.audioBlob);
            };

            const formatDate = (dateStr) => {
                const today = new Date().toLocaleDateString('de-DE');
                const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1000).toLocaleDateString('de-DE');
                if (dateStr === today) return 'Heute';
                if (dateStr === yesterday) return 'Gestern';
                return dateStr;
            };

            return (
                <div className="max-w-4xl mx-auto p-6 bg-gradient-to-br from-blue-50 to-indigo-100 rounded-lg">
                    <div className="grid md:grid-cols-2 gap-6">
                        <div className="bg-white rounded-lg shadow-lg p-6">
                            <h2 className="text-xl font-semibold mb-4 flex items-center">üé§ Neue Aufnahme</h2>
                            <div className="text-center mb-6">
                                <button onClick={isRecording ? stopRecording : startRecording}
                                    className={`w-20 h-20 rounded-full flex items-center justify-center text-white text-2xl transition-all duration-300 ${isRecording ? 'bg-red-500 hover:bg-red-600 animate-pulse' : 'bg-blue-500 hover:bg-blue-600'}`}
                                >
                                    {isRecording ? 'üõë' : 'üéôÔ∏è'}
                                </button>
                                <p className="mt-2 text-sm text-gray-600">
                                    {isRecording ? 'Aufnahme l√§uft...' : 'Klicken zum Aufnehmen'}
                                </p>
                            </div>
                            {audioBlob && (
                                <div className="mb-4">
                                    <div className="flex justify-center gap-3 mb-3">
                                        <button onClick={playAudio} className="flex items-center gap-2 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600">
                                            {isPlaying ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è'} {isPlaying ? 'Pausieren' : 'Abspielen'}
                                        </button>
                                        <button onClick={clearCurrentMemo} className="flex items-center gap-2 bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600">
                                            üóëÔ∏è L√∂schen
                                        </button>
                                    </div>
                                    <audio ref={audioRef} className="hidden" />
                                </div>
                            )}

                            {transcript && (
                                <div className="mb-4">
                                    <h3 className="font-semibold mb-2">Transkription:</h3>
                                    <div className="bg-gray-50 p-3 rounded-lg text-sm max-h-32 overflow-y-auto">{transcript}</div>
                                </div>
                            )}

                            {summary && (
                                <div className="mb-4">
                                    <h3 className="font-semibold mb-2">Zusammenfassung:</h3>
                                    <div className="bg-blue-50 p-3 rounded-lg text-sm whitespace-pre-line">{summary}</div>
                                </div>
                            )}

                            {(transcript || audioBlob) && (
                                <button onClick={saveMemo} className="w-full flex items-center justify-center gap-2 bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700">
                                    üíæ Memo speichern
                                </button>
                            )}
                        </div>

                        <div className="bg-white rounded-lg shadow-lg p-6">
                            <h2 className="text-xl font-semibold mb-4 flex items-center">üìÖ Gespeicherte Memos ({memos.length})</h2>
                            <div className="space-y-3 max-h-96 overflow-y-auto">
                                {memos.length === 0 ? (
                                    <p className="text-gray-500 text-center py-8">Noch keine Memos vorhanden</p>
                                ) : (
                                    memos.map(memo => (
                                        <div key={memo.id} className="border rounded-lg p-3 hover:bg-gray-50 cursor-pointer transition-colors" onClick={() => loadMemo(memo)}>
                                            <div className="flex justify-between items-start mb-2">
                                                <div className="text-sm text-gray-600">{formatDate(memo.date)} - {memo.time}</div>
                                                <button onClick={e => { e.stopPropagation(); deleteMemo(memo.id); }} className="text-red-500 hover:text-red-700">üóëÔ∏è</button>
                                            </div>
                                            {memo.summary && (
                                                <div className="text-sm text-gray-700 mb-2">
                                                    {memo.summary.split('\n').slice(0, 2).join('\n')}
                                                    {memo.summary.split('\n').length > 2 && '...'}
                                                </div>
                                            )}
                                            <div className="flex items-center gap-2 text-xs text-gray-500">
                                                {memo.audioBlob && 'üîä'}
                                                <span>{memo.transcript.length > 0 && `${memo.transcript.length} Zeichen`}</span>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('voiceMemoApp')).render(<VoiceMemoApp />);
    </script>
</body>
</html>
